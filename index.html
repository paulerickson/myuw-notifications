<html>
    <head>
        <style>
            body {
                padding: 0;
                margin: 0;
                background: #ccc;
                font-family: Arial, Helvetica, sans-serif;
            }
            .demo-content {
              padding: 24px;
            }
            .demo-content button {
              font-size: 18px;
              padding: 8px 16px;
              border-radius: 3px;
              height: 48px;
              background: #fafafa;
              color: #222;
              box-shadow: 0 2px 5px 0 rgba(0,0,0,.26);
            }
        </style>

        <script src="https://unpkg.com/css-vars-ponyfill@1"></script>
        <script>
          cssVars({shadowDOM: true,watch: true});
        </script>
        <!-- Web component polyfill loader -->
        <script src="https://unpkg.com/@webcomponents/webcomponentsjs@2.1.3/webcomponents-loader.js"></script>

        <script type="module" src="https://unpkg.com/@myuw-web-components/myuw-app-styles@^1?module"></script>
        <script nomodule src="https://unpkg.com/@myuw-web-components/myuw-app-styles@^1"></script>

        <script type="module" src="https://unpkg.com/@myuw-web-components/myuw-app-bar@^1?module"></script>
        <script nomodule src="https://unpkg.com/@myuw-web-components/myuw-app-bar@^1"></script>

        <script type="module" src="./dist/myuw-notifications.mjs"></script>
        <script nomodule src="./dist/myuw-notifications.mjs"></script>
    </head>
    <body>
        <!-- App bar with bell button -->
        <myuw-app-bar
            theme-name="MyUW"
            app-name="Notifications Demo"
            app-url=""
            background="rgb(197, 5, 12)"
            color="white">
          <myuw-notifications
              see-all-url="/"
              slot="myuw-notifications">
              <span slot="myuw-notifications-empty">All caught up!</span>
          </myuw-notifications>
        </myuw-app-bar>

        <!-- Demo content -->
        <div class="demo-content">
          <button onclick="getNotifications()">Look up test notifications</button>
        </div>

        <!-- Functions for demo content -->
        <script>
          /* get test notifications */
          function getNotifications() {
            fetch('./test/messages.json')
              .then(res => {
                // Check if the request was valid
                if(res.status === 200){
                  res.json()
                  .then( data => {
                    // If data.person is not set, return.
                    if(!data.messages) { return; }

                    // Set user data to the component
                    var customEvent = new CustomEvent('myuw-has-notifications', {
                      bubbles: true,
                      detail: {
                        notifications: data.messages
                      }
                    });
                    document.dispatchEvent(customEvent);
                  })
                } else {
                  var customEvent = new CustomEvent('myuw-has-messages', {
                    bubbles: true,
                    detail: {
                      notifications: null
                    }
                  });
                  document.dispatchEvent(customEvent);
                }
            })
            .catch( e => {
              var customEvent = new CustomEvent('myuw-has-messages', {
                bubbles: true,
                detail: {
                  notifications: null
                }
              });
              document.dispatchEvent(customEvent);
            } );
          }

          document.addEventListener('myuw-notification-dismissed', (event) => {
            // Process data passed with event
            console.log('dismissed notification with id: ' + event.detail.notificationId);
          }, false);
        </script>
    </body>
</html>
